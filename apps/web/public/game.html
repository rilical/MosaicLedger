<!doctype html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" /><title>Minesweeper (180s)</title><style>:root{--bg0:#0b1220;--bg1:#050712;--card:rgba(255,255,255,0.06);--t:#eef2ff;--mut:rgba(238,242,255,0.7);--b:rgba(255,255,255,0.12);--good:#22c55e;--warn:#f97316;--bad:#f43f5e;--accent:#38bdf8;--cell:#0f1a30;--cell2:#0b1528;--rev:#0a1020}*{box-sizing:border-box}html,body{height:100%}body{margin:0;font:14px/1.4 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;color:var(--t);background:radial-gradient( 1200px 700px at 20% 0%,#182a55 0%,var(--bg0) 42%,var(--bg1) 100% );display:flex;align-items:center;justify-content:center;padding:12px;box-sizing:border-box;overflow-x:hidden;min-height:100%}.app{width:100%;max-width:min(520px,100vw);display:grid;gap:14px;box-sizing:border-box}.top{display:flex;gap:10px;align-items:flex-start;justify-content:space-between}h1{margin:0;font-size:18px;letter-spacing:0.2px}.meta{color:var(--mut);font-size:12px}.card{background:var(--card);border:1px solid var(--b);border-radius:14px;padding:12px}.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}.pill{border:1px solid var(--b);border-radius:999px;padding:6px 10px;background:rgba(0,0,0,0.22);font-size:12px}.pill b{font-weight:700}.btns{display:flex;gap:8px;flex-wrap:wrap}button{appearance:none;border:1px solid var(--b);background:rgba(0,0,0,0.24);color:var(--t);border-radius:12px;padding:8px 10px;font-weight:650}button:active{transform:translateY(1px)}.primary{border-color:rgba(56,189,248,0.45);background:rgba(56,189,248,0.14)}.on{border-color:rgba(249,115,22,0.55);background:rgba(249,115,22,0.18)}.grid{display:grid;grid-template-columns:repeat(10,minmax(0,1fr));gap:6px;user-select:none;touch-action:manipulation;width:100%;max-width:100%}.c{position:relative;width:100%;aspect-ratio:1/1;border-radius:10px;border:1px solid rgba(255,255,255,0.08);background:linear-gradient(180deg,var(--cell),var(--cell2));color:var(--t);font-weight:800;display:flex;align-items:center;justify-content:center}.c.rev{background:linear-gradient(180deg,rgba(0,0,0,0.35),rgba(0,0,0,0.25));border-color:rgba(255,255,255,0.1)}.c.rev.mine{background:linear-gradient(180deg,rgba(244,63,94,0.25),rgba(0,0,0,0.25));border-color:rgba(244,63,94,0.4)}.c.flag{outline:2px solid rgba(234,179,8,0.45)}.c.boom{background:linear-gradient(180deg,rgba(244,63,94,0.38),rgba(0,0,0,0.25));border-color:rgba(244,63,94,0.55)}.scotty{position:absolute;left:0;right:0;bottom:0;width:100%;aspect-ratio:1;transform:translateY(-20px);border-radius:10px;pointer-events:none;background-color:transparent;background-repeat:no-repeat;background-position:center;background-size:contain}.scotty-nervous{background-image:url(/scotty-tl.png)}.scotty-shocked{background-image:url(/scotty-tr.png)}.scotty-win{background-image:url(/scotty-bl.png);clip-path:inset(0 10px 5px 0);transform:translateY(-10px)}.scotty-bomb{background-image:url(/scotty-br.png)}@keyframes scotty-fade-in{from{opacity:0}to{opacity:1}}@keyframes scotty-fade-out{from{opacity:1}to{opacity:0}}@keyframes pulse-opacity{0%,100%{opacity:1}50%{opacity:0.4}}.scotty{opacity:0;animation:scotty-fade-in 0.3s ease-out forwards}.scotty.scotty-out{animation:scotty-fade-out 0.25s ease-out forwards}.scotty.scotty-bomb{animation:scotty-fade-in 0.3s ease-out forwards,pulse-opacity 1.5s ease-in-out 0.3s infinite}.grid-wrap{position:relative}.center-scotty{position:absolute;left:50%;top:50%;transform:translate(-50%,calc(-50% - 25px)) scale(0.75);width:88px;aspect-ratio:1;pointer-events:none;background-color:transparent;background-image:url(/scotty-bl.png);background-repeat:no-repeat;background-position:center;background-size:contain;clip-path:inset(0 10px 5px 0);opacity:0}.center-scotty.scotty-fade-in{animation:scotty-fade-in 0.3s ease-out forwards,pulse-opacity 1.5s ease-in-out 0.3s infinite}.center-scotty.scotty-out{animation:scotty-fade-out 0.25s ease-out forwards}.c:focus{outline:2px solid rgba(56,189,248,0.55);outline-offset:1px}.hint{color:var(--mut);font-size:12px}a{color:var(--accent)}#status.status-pulse{animation:pulse-opacity 1.5s ease-in-out infinite}</style></head><body><div class="app"><div class="top"><div><div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap"><h1>Minesweeper (180s)</h1><a class="pill" href="/app/evidence" style="text-decoration: none; color: inherit; display: inline-flex" >Back</a ></div><div class="meta">10x10 · 15 mines · first click safe</div></div><a class="pill primary" id="dashboardBtn" href="/app" style="text-decoration: none; color: inherit; display: inline-flex" >Dashboard</a ><div class="pill" id="status" style="display: none">READY</div></div><div class="card"><div class="row"><div class="pill">Time: <b id="time">180</b>s</div><div class="pill">Mines: <b id="mines">15</b></div><div class="pill">Safe left: <b id="left">85</b></div><div class="btns"><button id="flag" class="primary" type="button">Flag: OFF</button><button id="restart" type="button">Restart</button></div></div></div><div class="card"><div class="grid-wrap"><div class="grid" id="grid" aria-label="Minesweeper board"></div><div class="center-scotty" id="centerScotty" aria-hidden="true"></div></div></div></div><script>!function(){var e=document.getElementById("grid"),t=document.getElementById("time"),n=document.getElementById("mines"),a=document.getElementById("left"),o=document.getElementById("dashboardBtn"),r=document.getElementById("status"),i=document.getElementById("centerScotty"),c=document.getElementById("flag"),l=document.getElementById("restart"),s=0,u=0,f=0,m=0,d=180,v=location.search.match(/(?:\\?|&)seed=([^&]+)/),p=null,g=0;function y(){if(!p)try{p=new(window.AudioContext||window.webkitAudioContext)}catch(e){}return p}function h(e,t){var n,a,o,r,i,c=60/72,l=[[329.63,0,1],[329.63,1,1],[392,2,2],[261.63,4,1],[246.94,5,1],[220,6,2],[196,8,1],[220,9,1],[246.94,10,1],[261.63,11,1]];for(n=0;n<l.length;n++)a=t+l[n][1]*c,o=l[n][2]*c,r=e.createOscillator(),i=e.createGain(),r.type="triangle",r.frequency.setValueAtTime(l[n][0],a),i.gain.setValueAtTime(0,a),i.gain.linearRampToValueAtTime(.18,a+.06),i.gain.linearRampToValueAtTime(.11,a+o-.08),i.gain.linearRampToValueAtTime(.001,a+o),r.connect(i),i.connect(e.destination),r.start(a),r.stop(a+o);setTimeout(function(){h(e,t+10)},9800)}function T(){if(!g){g=1;var e=y();if(e)try{"suspended"===e.state&&e.resume(),h(e,e.currentTime)}catch(e){}}}var x,C=(x=function(e){for(var t=0,n=2166136261;t<e.length;t++)n^=e.charCodeAt(t),n=Math.imul(n,16777619);return n>>>0}(decodeURIComponent(v?v[1]:"0")),function(){x=1831565813+(x|=0)|0;var e=Math.imul(x^x>>>15,1|x);return(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296});function A(e,t){return 10*e+t}function E(e,t){return e>=0&&t>=0&&e<10&&t<10}function L(e){for(var t=e/10|0,n=e%10,a=[],o=-1;o<=1;o++)for(var r=-1;r<=1;r++)if(o||r){var i=t+o,c=n+r;E(i,c)&&a.push(A(i,c))}return a}function I(e){r.textContent=e,o.style.display="none",r.style.display="inline-flex","READY"===e?r.classList.add("status-pulse"):r.classList.remove("status-pulse")}function R(){e.innerHTML="",w=null,f=0,u=0,d=180,t.textContent=d,I("READY"),b=[];for(var o=0;o<100;o++)b.push({m:0,r:0,f:0,a:0,b:0,el:null});for(o=0;o<100;o++){var r=document.createElement("button");r.type="button",r.className="c",r.setAttribute("aria-label","cell"),function(e,t){t.oncontextmenu=function(t){return t.preventDefault(),V(e),0};var n=0,a=0;t.ontouchstart=function(){n=0,a=setTimeout(function(){n=1,V(e)},380)},t.ontouchend=function(){clearTimeout(a),n||B(e)},t.onclick=function(){B(e)}}(o,r),b[o].el=r,e.appendChild(r)}n.textContent=15,M=85,a.textContent=M,i&&(i.style.display="",i.classList.remove("scotty-out","scotty-fade-in"),i.offsetHeight,i.classList.add("scotty-fade-in"))}function V(e){if(!f){var t=b[e];if(!t.r){t.f=!t.f,t.el.classList.toggle("flag",t.f),t.el.textContent=t.f?"F":"";for(var a=0,o=0;o<100;o++)b[o].f&&a++;n.textContent=Math.max(0,15-a)}}}function B(e){if(!f){u||(function(e){var t={};t[e]=1;for(var n=L(e),a=0;a<n.length;a++)t[n[a]]=1;var o=[];for(a=0;a<100;a++)t[a]||o.push(a);for(var r=o.length-1;r>0;r--){var i=C()*(r+1)|0,c=o[r];o[r]=o[i],o[i]=c}for(a=0;a<15;a++)b[o[a]].m=1;for(a=0;a<100;a++)if(!b[a].m){var l=L(a),s=0;for(i=0;i<l.length;i++)b[l[i]].m&&s++;b[a].a=s}}(e),u||(u=1,i&&(i.classList.remove("scotty-fade-in"),i.classList.add("scotty-out"),i.addEventListener("animationend",function e(){i.removeEventListener("animationend",e),i.style.display="none",i.classList.remove("scotty-out")})),I("RUNNING"),m=setInterval(function(){f||(d--,t.textContent=d,d<=0&&N(-1))},1e3)));var o=b[e];if(s)V(e);else if(!o.f&&!o.r)if(o.m)N(e);else{if(w&&w.parentNode){var r=w;return w=null,r.classList.add("scotty-out"),void r.addEventListener("animationend",function e(){r.removeEventListener("animationend",e),r.parentNode&&r.parentNode.removeChild(r),c()})}c()}}function c(){!function(e){for(var t=[e];t.length;){var o=t.pop(),r=b[o];if(!r.r){if(r.f){r.f=0,r.el.classList.remove("flag"),r.el.textContent="";for(var i=0,c=0;c<100;c++)b[c].f&&i++;n.textContent=Math.max(0,15-i)}if(r.r=1,M--,a.textContent=M,r.el.classList.add("rev"),r.a)r.el.textContent=r.a;else for(var l=L(o),s=0;s<l.length;s++){var u=b[l[s]];u.r||u.m||t.push(l[s])}}}}(e);var t=o.a>=3?"shocked":"nervous";w=O(o.el,t),M<=0&&(f=1,clearInterval(m),function(){var e=y();if(e)try{"suspended"===e.state&&e.resume();for(var t=e.currentTime,n=[523.25,659.25,783.99,1046.5],a=0;a<n.length;a++)(function(n,a){var o=e.createOscillator();o.type="square",o.frequency.setValueAtTime(n,t);var r=e.createGain();r.gain.setValueAtTime(0,t),r.gain.linearRampToValueAtTime(.12,t+.03),r.gain.exponentialRampToValueAtTime(.01,t+.25),o.connect(r),r.connect(e.destination),o.start(t+.12*a),o.stop(t+.12*a+.25)})(n[a],a)}catch(e){}}(),I("CLEARED"),w&&(w.className="scotty scotty-win"))}}function N(e){f=1,clearInterval(m),function(){var e=y();if(e)try{"suspended"===e.state&&e.resume();for(var t=e.currentTime,n=e.createBuffer(1,.15*e.sampleRate,e.sampleRate),a=n.getChannelData(0),o=0;o<a.length;o++)a[o]=(2*Math.random()-1)*Math.pow(1-o/a.length,2);var r=e.createBufferSource();r.buffer=n;var i=e.createGain();i.gain.setValueAtTime(.4,t),i.gain.exponentialRampToValueAtTime(.01,t+.15),r.connect(i),i.connect(e.destination),r.start(t);var c=e.createOscillator();c.type="sawtooth",c.frequency.setValueAtTime(80,t),c.frequency.exponentialRampToValueAtTime(20,t+.1);var l=e.createGain();l.gain.setValueAtTime(.25,t),l.gain.exponentialRampToValueAtTime(.01,t+.12),c.connect(l),l.connect(e.destination),c.start(t),c.stop(t+.12)}catch(e){}}(),I(e<0?"TIME OUT":"BOOM");for(var t=0;t<100;t++){var n=b[t];n.m&&(n.el.textContent="*",n.el.classList.add("rev","mine"))}e>=0&&(w&&w.parentNode&&(w.parentNode.removeChild(w),w=null),b[e].el.classList.add("boom"),O(b[e].el,"bomb"))}c.onclick=function(){s=!s,c.textContent="Flag: "+(s?"ON":"OFF"),c.classList.toggle("on",s)},l.onclick=function(){clearInterval(m),R()};var b=[],M=0,w=null;function O(e,t){var n=document.createElement("div");return n.className="scotty scotty-"+t,e.appendChild(n),n}R(),document.addEventListener("click",function e(){document.removeEventListener("click",e),T()},{once:1})}();</script></body></html>
